/* Implements the parula color map as a function. */

const parulaMap = [
  [0.2422,0.1504,0.6603],
  [0.2448,0.1541,0.6750],
  [0.2471,0.1583,0.6889],
  [0.2495,0.1630,0.7022],
  [0.2517,0.1679,0.7151],
  [0.2539,0.1729,0.7279],
  [0.2560,0.1778,0.7406],
  [0.2581,0.1826,0.7534],
  [0.2602,0.1873,0.7663],
  [0.2622,0.1919,0.7793],
  [0.2643,0.1966,0.7922],
  [0.2662,0.2013,0.8048],
  [0.2679,0.2062,0.8171],
  [0.2696,0.2112,0.8290],
  [0.2712,0.2166,0.8402],
  [0.2726,0.2221,0.8509],
  [0.2740,0.2279,0.8610],
  [0.2750,0.2338,0.8704],
  [0.2761,0.2400,0.8792],
  [0.2770,0.2464,0.8876],
  [0.2779,0.2528,0.8955],
  [0.2787,0.2593,0.9029],
  [0.2794,0.2658,0.9099],
  [0.2799,0.2724,0.9165],
  [0.2804,0.2790,0.9228],
  [0.2808,0.2855,0.9288],
  [0.2811,0.2921,0.9344],
  [0.2813,0.2986,0.9398],
  [0.2814,0.3052,0.9450],
  [0.2814,0.3117,0.9499],
  [0.2812,0.3181,0.9547],
  [0.2809,0.3246,0.9591],
  [0.2807,0.3310,0.9634],
  [0.2802,0.3375,0.9674],
  [0.2796,0.3439,0.9712],
  [0.2787,0.3503,0.9748],
  [0.2778,0.3567,0.9783],
  [0.2767,0.3632,0.9814],
  [0.2753,0.3697,0.9842],
  [0.2737,0.3762,0.9867],
  [0.2719,0.3829,0.9889],
  [0.2698,0.3895,0.9907],
  [0.2674,0.3962,0.9922],
  [0.2647,0.4030,0.9935],
  [0.2615,0.4099,0.9948],
  [0.2578,0.4167,0.9959],
  [0.2534,0.4235,0.9970],
  [0.2484,0.4304,0.9981],
  [0.2427,0.4374,0.9990],
  [0.2362,0.4444,0.9996],
  [0.2293,0.4516,0.9992],
  [0.2220,0.4589,0.9977],
  [0.2148,0.4662,0.9955],
  [0.2075,0.4734,0.9929],
  [0.2003,0.4806,0.9905],
  [0.1939,0.4874,0.9882],
  [0.1889,0.4942,0.9857],
  [0.1856,0.5008,0.9829],
  [0.1834,0.5073,0.9798],
  [0.1818,0.5137,0.9767],
  [0.1804,0.5200,0.9733],
  [0.1792,0.5262,0.9698],
  [0.1781,0.5324,0.9658],
  [0.1774,0.5386,0.9613],
  [0.1768,0.5447,0.9564],
  [0.1763,0.5509,0.9512],
  [0.1751,0.5568,0.9462],
  [0.1729,0.5628,0.9414],
  [0.1696,0.5688,0.9370],
  [0.1655,0.5747,0.9329],
  [0.1609,0.5806,0.9288],
  [0.1566,0.5864,0.9246],
  [0.1529,0.5921,0.9204],
  [0.1501,0.5977,0.9162],
  [0.1479,0.6032,0.9121],
  [0.1462,0.6087,0.9082],
  [0.1444,0.6141,0.9046],
  [0.1422,0.6195,0.9014],
  [0.1395,0.6250,0.8986],
  [0.1363,0.6303,0.8960],
  [0.1325,0.6358,0.8934],
  [0.1286,0.6411,0.8908],
  [0.1244,0.6464,0.8881],
  [0.1204,0.6516,0.8850],
  [0.1164,0.6568,0.8815],
  [0.1125,0.6619,0.8776],
  [0.1085,0.6669,0.8734],
  [0.1041,0.6717,0.8687],
  [0.0992,0.6765,0.8637],
  [0.0936,0.6811,0.8583],
  [0.0870,0.6856,0.8526],
  [0.0794,0.6899,0.8466],
  [0.0703,0.6942,0.8403],
  [0.0600,0.6982,0.8338],
  [0.0485,0.7022,0.8271],
  [0.0362,0.7061,0.8202],
  [0.0247,0.7099,0.8132],
  [0.0152,0.7134,0.8061],
  [0.0081,0.7170,0.7989],
  [0.0035,0.7204,0.7915],
  [0.0013,0.7237,0.7840],
  [0.0016,0.7269,0.7765],
  [0.0045,0.7300,0.7689],
  [0.0105,0.7331,0.7612],
  [0.0194,0.7360,0.7535],
  [0.0315,0.7389,0.7457],
  [0.0466,0.7417,0.7378],
  [0.0626,0.7444,0.7298],
  [0.0782,0.7470,0.7218],
  [0.0934,0.7495,0.7137],
  [0.1078,0.7520,0.7056],
  [0.1213,0.7545,0.6974],
  [0.1337,0.7569,0.6892],
  [0.1450,0.7593,0.6810],
  [0.1548,0.7618,0.6726],
  [0.1636,0.7643,0.6643],
  [0.1715,0.7669,0.6557],
  [0.1786,0.7694,0.6471],
  [0.1850,0.7720,0.6382],
  [0.1912,0.7746,0.6292],
  [0.1970,0.7772,0.6199],
  [0.2033,0.7798,0.6105],
  [0.2101,0.7822,0.6008],
  [0.2171,0.7847,0.5909],
  [0.2249,0.7870,0.5807],
  [0.2339,0.7892,0.5702],
  [0.2441,0.7913,0.5596],
  [0.2553,0.7931,0.5488],
  [0.2675,0.7948,0.5377],
  [0.2809,0.7964,0.5266],
  [0.2952,0.7977,0.5152],
  [0.3098,0.7988,0.5037],
  [0.3246,0.7998,0.4920],
  [0.3393,0.8007,0.4800],
  [0.3539,0.8016,0.4676],
  [0.3685,0.8022,0.4550],
  [0.3833,0.8027,0.4421],
  [0.3984,0.8030,0.4290],
  [0.4140,0.8030,0.4158],
  [0.4303,0.8028,0.4028],
  [0.4470,0.8024,0.3899],
  [0.4642,0.8016,0.3772],
  [0.4814,0.8007,0.3647],
  [0.4987,0.7997,0.3522],
  [0.5157,0.7984,0.3396],
  [0.5326,0.7970,0.3269],
  [0.5493,0.7955,0.3141],
  [0.5657,0.7938,0.3012],
  [0.5822,0.7920,0.2883],
  [0.5985,0.7901,0.2756],
  [0.6148,0.7880,0.2632],
  [0.6310,0.7857,0.2512],
  [0.6470,0.7833,0.2397],
  [0.6629,0.7808,0.2287],
  [0.6787,0.7781,0.2184],
  [0.6942,0.7754,0.2088],
  [0.7094,0.7726,0.1996],
  [0.7244,0.7698,0.1909],
  [0.7393,0.7669,0.1824],
  [0.7539,0.7639,0.1744],
  [0.7682,0.7610,0.1672],
  [0.7823,0.7580,0.1610],
  [0.7961,0.7551,0.1567],
  [0.8096,0.7521,0.1542],
  [0.8228,0.7493,0.1536],
  [0.8356,0.7464,0.1543],
  [0.8483,0.7438,0.1562],
  [0.8607,0.7412,0.1589],
  [0.8729,0.7387,0.1624],
  [0.8848,0.7364,0.1670],
  [0.8964,0.7342,0.1729],
  [0.9076,0.7324,0.1803],
  [0.9184,0.7308,0.1890],
  [0.9288,0.7297,0.1989],
  [0.9388,0.7288,0.2094],
  [0.9486,0.7284,0.2199],
  [0.9585,0.7285,0.2293],
  [0.9683,0.7292,0.2369],
  [0.9778,0.7307,0.2421],
  [0.9860,0.7341,0.2441],
  [0.9922,0.7386,0.2412],
  [0.9959,0.7441,0.2365],
  [0.9970,0.7505,0.2315],
  [0.9972,0.7572,0.2265],
  [0.9971,0.7639,0.2214],
  [0.9968,0.7707,0.2163],
];

function parulaColorMap(t) {
  index = Math.round(t*(parulaMap.length-1));
  c = parulaMap[index];
  color = new THREE.Color(c[0],c[1],c[2]);
  return color;
}
